<%- include('../partials/header') %>

<div class="container" style="margin-top: 3rem; margin-bottom: 4rem;">
  <h1>Edit Milestone</h1>

  <% if (error) { %>
    <div class="alert alert-error"><%= error %></div>
  <% } %>

  <form action="/user/milestones/<%= milestone.milestone_id %>/edit" method="POST">
    <div class="form-group">
      <label for="milestone_title">Title</label>
      <input type="text" name="milestone_title" id="milestone_title" class="form-input" value="<%= milestone.milestone_title %>" required>
    </div>
    <div class="form-group">
      <label for="milestone_category">Category</label>
      <select id="milestone_category" name="milestone_category" class="form-select" required>
        <option value="">Select a category...</option>
        <% if (categories && categories.length > 0) { %>
          <% categories.forEach(cat => { %>
            <option value="<%= cat.milestone_category %>" <%= milestone.milestone_category === cat.milestone_category ? 'selected' : '' %>><%= cat.milestone_category %></option>
          <% }) %>
        <% } else { %>
          <option value="Education" <%= milestone.milestone_category === 'Education' ? 'selected' : '' %>>Education</option>
          <option value="Career" <%= milestone.milestone_category === 'Career' ? 'selected' : '' %>>Career</option>
          <option value="Personal" <%= milestone.milestone_category === 'Personal' ? 'selected' : '' %>>Personal</option>
          <option value="Community" <%= milestone.milestone_category === 'Community' ? 'selected' : '' %>>Community</option>
          <option value="Health" <%= milestone.milestone_category === 'Health' ? 'selected' : '' %>>Health</option>
          <option value="Financial" <%= milestone.milestone_category === 'Financial' ? 'selected' : '' %>>Financial</option>
        <% } %>
      </select>
    </div>
    <div class="form-group">
      <label for="milestone_date">Date</label>
      <input type="date" name="milestone_date" id="milestone_date" class="form-input" value="<%= milestone.milestone_date ? new Date(milestone.milestone_date).toISOString().split('T')[0] : '' %>" required>
    </div>
    <button type="submit" class="btn btn-primary">Update Milestone</button>
    <a href="/user/milestones" class="btn btn-outline">Cancel</a>
  </form>
</div>

<%- include('../partials/footer') %>
