<%- include('../partials/header') %>

<div class="container" style="margin-top: 3rem; margin-bottom: 3rem;">
  <div style="max-width: 800px; margin: 0 auto;">
    <!-- Back Button -->
    <a href="/admin/events" style="color: #CE325B; margin-bottom: 2rem; display: inline-block;">
      ‚Üê Back to Events Management
    </a>

    <div class="card">
      <h1 class="card-title"><%= event ? 'Edit Event' : 'Create New Event' %></h1>

      <% if (error) { %>
        <div class="alert alert-error" style="margin-bottom: 1.5rem;">
          <%= error %>
        </div>
      <% } %>

      <form action="<%= event ? `/admin/events/${event.event_occurance_id}/edit` : '/admin/events/new' %>" method="POST" enctype="multipart/form-data">
        <div class="form-group">
          <label for="title" class="form-label">Event Title *</label>
          <input
            type="text"
            id="title"
            name="title"
            class="form-input"
            value="<%= event ? event.title : '' %>"
            required
          />
        </div>

        <div class="form-group">
          <label for="description" class="form-label">Description *</label>
          <textarea
            id="description"
            name="description"
            class="form-textarea"
            rows="6"
            required
          ><%= event ? event.description : '' %></textarea>
        </div>

        <div class="grid grid-2">
          <div class="form-group">
            <label for="date" class="form-label">Date & Time *</label>
            <input
              type="datetime-local"
              id="date"
              name="date"
              class="form-input"
              value="<%= event ? new Date(event.event_date_time_start).toISOString().slice(0, 16) : '' %>"
              required
            />
          </div>

          <div class="form-group">
            <label for="location" class="form-label">Location</label>
            <input
              type="text"
              id="location"
              name="location"
              class="form-input"
              value="<%= event ? (event.event_location || '') : '' %>"
              placeholder="Location (optional)"
            />
          </div>
        </div>

        <div class="form-group">
          <label for="capacity" class="form-label">Capacity</label>
          <input
            type="number"
            id="capacity"
            name="capacity"
            class="form-input"
            value="<%= event ? (event.event_capacity || '') : '' %>"
            placeholder="Leave blank for unlimited"
            min="1"
          />
        </div>

        <div class="form-group">
          <label for="event_image" class="form-label">
            Event Image
            <span style="color: var(--text-secondary); font-size: 0.9rem; font-weight: normal;">
              (Max 5MB, formats: jpg, png, gif, webp)
            </span>
          </label>

          <% if (event && event.image_url) { %>
            <div style="margin-bottom: 1rem;">
              <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">Current image:</p>
              <img src="<%= event.image_url %>" alt="<%= event.title %>" style="max-width: 300px; border-radius: var(--border-radius); border: 1px solid var(--border-color);">
            </div>
          <% } %>

          <input
            type="file"
            id="event_image"
            name="event_image"
            class="form-input"
            accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
          />
          <p class="form-helper" style="margin-top: 0.5rem;">
            <%= event ? 'Upload a new image to replace the current one (optional)' : 'Optional - you can add an image later' %>
          </p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
          <button type="submit" class="btn btn-primary btn-lg">
            <%= event ? 'Update Event' : 'Create Event' %>
          </button>
          <a href="/admin/events" class="btn btn-outline btn-lg">Cancel</a>
        </div>
      </form>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
