<%- include('../partials/header') %>

<div class="container" style="margin-top: 3rem; margin-bottom: 3rem;">
  <div style="max-width: 700px; margin: 0 auto;">
    <!-- Back Button -->
    <a href="/admin/participants/<%= participant.id %>" style="color: #CE325B; margin-bottom: 2rem; display: inline-block;">
      ‚Üê Back to <%= participant.participant_first_name %>'s Profile
    </a>

    <div class="card">
      <h1 class="card-title"><%= milestone ? 'Edit Milestone' : 'Add New Milestone' %></h1>

      <% if (error) { %>
        <div class="alert alert-error" style="margin-bottom: 1.5rem;">
          <%= error %>
        </div>
      <% } %>

      <form action="<%= milestone ? `/admin/participants/${participant.id}/milestones/${milestone.milestone_id}/edit` : `/admin/participants/${participant.id}/milestones/new` %>" method="POST">
        <div class="form-group">
          <label for="title" class="form-label">Milestone Title *</label>
          <input
            type="text"
            id="title"
            name="title"
            class="form-input"
            value="<%= milestone ? milestone.milestone_title : '' %>"
            required
            placeholder="e.g., First Event Attended, 10 Hours Volunteered"
          />
        </div>

        <div class="form-group">
          <label for="category" class="form-label">Category</label>
          <select id="category" name="category" class="form-select">
            <option value="">Select a category (optional)</option>
            <option value="Events" <%= milestone && milestone.milestone_category === 'Events' ? 'selected' : '' %>>Events</option>
            <option value="Volunteering" <%= milestone && milestone.milestone_category === 'Volunteering' ? 'selected' : '' %>>Volunteering</option>
            <option value="Donations" <%= milestone && milestone.milestone_category === 'Donations' ? 'selected' : '' %>>Donations</option>
            <option value="Programs" <%= milestone && milestone.milestone_category === 'Programs' ? 'selected' : '' %>>Programs</option>
            <option value="Leadership" <%= milestone && milestone.milestone_category === 'Leadership' ? 'selected' : '' %>>Leadership</option>
            <option value="Education" <%= milestone && milestone.milestone_category === 'Education' ? 'selected' : '' %>>Education</option>
            <option value="Community" <%= milestone && milestone.milestone_category === 'Community' ? 'selected' : '' %>>Community</option>
            <option value="Other" <%= milestone && milestone.milestone_category === 'Other' ? 'selected' : '' %>>Other</option>
          </select>
          <p class="form-helper">Optional - categorize this milestone for better organization</p>
        </div>

        <div class="form-group">
          <label for="date" class="form-label">Date Achieved *</label>
          <input
            type="date"
            id="date"
            name="date"
            class="form-input"
            value="<%= milestone && milestone.milestone_date ? new Date(milestone.milestone_date).toISOString().split('T')[0] : '' %>"
            required
          />
          <p class="form-helper">The date this milestone was achieved</p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
          <button type="submit" class="btn btn-primary btn-lg">
            <%= milestone ? 'Update Milestone' : 'Create Milestone' %>
          </button>
          <a href="/admin/participants/<%= participant.id %>" class="btn btn-outline btn-lg">Cancel</a>
        </div>
      </form>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
