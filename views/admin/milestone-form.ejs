<%- include('../partials/header') %>

<div class="container" style="margin-top: 3rem; margin-bottom: 3rem;">
  <div style="max-width: 700px; margin: 0 auto;">
    <!-- Back Button -->
    <a href="/admin/participants/<%= participant.id %>" style="color: #CE325B; margin-bottom: 2rem; display: inline-block;">
      ‚Üê Back to <%= participant.participant_first_name %>'s Profile
    </a>

    <div class="card">
      <h1 class="card-title"><%= milestone ? 'Edit Milestone' : 'Add New Milestone' %></h1>

      <% if (error) { %>
        <div class="alert alert-error" style="margin-bottom: 1.5rem;">
          <%= error %>
        </div>
      <% } %>

      <form action="<%= milestone ? `/admin/participants/${participant.id}/milestones/${milestone.milestone_id}/edit` : `/admin/participants/${participant.id}/milestones/new` %>" method="POST">
        <div class="form-group">
          <label for="title" class="form-label">Milestone Title *</label>
          <input
            type="text"
            id="title"
            name="title"
            class="form-input"
            value="<%= milestone ? milestone.milestone_title : '' %>"
            required
            placeholder="e.g., First Event Attended, 10 Hours Volunteered"
          />
        </div>

        <div class="form-group">
          <label for="category" class="form-label">Category</label>
          <select id="category" name="category" class="form-select">
            <option value="">Select a category (optional)</option>
            <option value="Apprenticeship" <%= milestone && milestone.milestone_category === 'Apprenticeship' ? 'selected' : '' %>>Apprenticeship</option>
            <option value="Associate's Degree" <%= milestone && milestone.milestone_category === "Associate's Degree" ? 'selected' : '' %>>Associate's Degree</option>
            <option value="Bachelor's Degree" <%= milestone && milestone.milestone_category === "Bachelor's Degree" ? 'selected' : '' %>>Bachelor's Degree</option>
            <option value="Career" <%= milestone && milestone.milestone_category === 'Career' ? 'selected' : '' %>>Career</option>
            <option value="Certificates & Awards" <%= milestone && milestone.milestone_category === 'Certificates & Awards' ? 'selected' : '' %>>Certificates & Awards</option>
            <option value="High School Diploma" <%= milestone && milestone.milestone_category === 'High School Diploma' ? 'selected' : '' %>>High School Diploma</option>
            <option value="Internship" <%= milestone && milestone.milestone_category === 'Internship' ? 'selected' : '' %>>Internship</option>
            <option value="Master's Degree" <%= milestone && milestone.milestone_category === "Master's Degree" ? 'selected' : '' %>>Master's Degree</option>
            <option value="Middle School Diploma" <%= milestone && milestone.milestone_category === 'Middle School Diploma' ? 'selected' : '' %>>Middle School Diploma</option>
            <option value="Project" <%= milestone && milestone.milestone_category === 'Project' ? 'selected' : '' %>>Project</option>
          </select>
          <p class="form-helper">Select a category to display in the participants table</p>
        </div>

        <div class="form-group">
          <label for="date" class="form-label">Date Achieved *</label>
          <input
            type="date"
            id="date"
            name="date"
            class="form-input"
            value="<%= milestone && milestone.milestone_date ? new Date(milestone.milestone_date).toISOString().split('T')[0] : '' %>"
            required
          />
          <p class="form-helper">The date this milestone was achieved</p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
          <button type="submit" class="btn btn-primary btn-lg">
            <%= milestone ? 'Update Milestone' : 'Create Milestone' %>
          </button>
          <a href="/admin/participants/<%= participant.id %>" class="btn btn-outline btn-lg">Cancel</a>
        </div>
      </form>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
